{% extends "base.html" %}

{% block page_title %}Edit Task{% endblock %}

{% block content %}

<div class="max-w-2xl">
    <a href="{{ url_for('index') }}" class="inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6 transition">
        <i class="fas fa-arrow-left"></i>
        Back to Tasks
    </a>

    <div class="bg-white rounded-lg border border-gray-200 p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">
            <i class="fas fa-edit text-blue-500 mr-2"></i>Edit Task
        </h2>

        <form method="POST" class="space-y-6">
            <!-- Task Title -->
            <div>
                <label for="title" class="block text-sm font-medium text-gray-700 mb-2">
                    Task Title <span class="text-red-500">*</span>
                </label>
                <input
                    type="text"
                    id="title"
                    name="title"
                    class="input-field w-full text-lg"
                    value="{{ task.title }}"
                    placeholder="Enter task title"
                    required
                >
            </div>

            <!-- Description -->
            <div>
                <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
                    Description
                </label>
                <textarea
                    id="description"
                    name="description"
                    class="input-field w-full"
                    rows="4"
                    placeholder="Add detailed description of the task..."
                >{{ task.description or '' }}</textarea>
            </div>

            <!-- Task Metadata Grid -->
            <div class="grid grid-cols-3 gap-4">
                <!-- Priority -->
                <div>
                    <label for="priority" class="block text-sm font-medium text-gray-700 mb-2">
                        Priority
                    </label>
                    <select id="priority" name="priority" class="input-field w-full">
                        <option value="1" {% if task.priority == 1 %}selected{% endif %}>
                            <i class="fas fa-arrow-down text-blue-500"></i> Low
                        </option>
                        <option value="2" {% if task.priority == 2 %}selected{% endif %}>
                            <i class="fas fa-arrow-right text-yellow-500"></i> Medium
                        </option>
                        <option value="3" {% if task.priority == 3 %}selected{% endif %}>
                            <i class="fas fa-arrow-up text-red-500"></i> High
                        </option>
                    </select>
                </div>

                <!-- Status -->
                <div>
                    <label for="status" class="block text-sm font-medium text-gray-700 mb-2">
                        Status
                    </label>
                    <select id="status" name="status" class="input-field w-full">
                        <option value="todo" {% if task.status == 'todo' %}selected{% endif %}>
                            To Do
                        </option>
                        <option value="doing" {% if task.status == 'doing' %}selected{% endif %}>
                            In Progress
                        </option>
                        <option value="done" {% if task.status == 'done' %}selected{% endif %}>
                            Completed
                        </option>
                    </select>
                </div>

                <!-- Due Date -->
                <div>
                    <label for="due_date" class="block text-sm font-medium text-gray-700 mb-2">
                        Due Date
                    </label>
                    <input
                        type="date"
                        id="due_date"
                        name="due_date"
                        class="input-field w-full"
                        value="{{ task.due_date or '' }}"
                    >
                </div>
            </div>

            <!-- Completion Checkbox -->
            <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                <label class="flex items-center gap-3 cursor-pointer">
                    <input
                        type="checkbox"
                        name="completed"
                        class="w-4 h-4 rounded border-gray-300 text-green-600"
                        {% if task.completed %}checked{% endif %}
                    >
                    <span class="text-sm font-medium text-gray-700">Mark as completed</span>
                </label>
            </div>

            <!-- Task Metadata Display -->
            <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
                <p class="text-sm text-blue-900 mb-2">
                    <i class="fas fa-info-circle mr-2"></i>Task Information
                </p>
                <div class="text-sm text-blue-800 space-y-1">
                    <p><strong>Created:</strong> {{ task.created_at or 'N/A' }}</p>
                    <p><strong>Last Updated:</strong> {{ task.updated_at or task.created_at or 'N/A' }}</p>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex gap-3 pt-4 border-t">
                <button type="submit" class="btn-primary flex items-center gap-2">
                    <i class="fas fa-save"></i>
                    Save Changes
                </button>
                <a href="{{ url_for('index') }}" class="btn-secondary flex items-center gap-2">
                    <i class="fas fa-times"></i>
                    Cancel
                </a>
                <a href="{{ url_for('delete', id=task.id) }}" 
                   class="btn-danger flex items-center gap-2 ml-auto"
                   onclick="return confirm('Are you sure you want to delete this task? This action cannot be undone.')">
                    <i class="fas fa-trash"></i>
                    Delete Task
                </a>
            </div>
        </form>
    </div>
</div>

{% endblock %}
